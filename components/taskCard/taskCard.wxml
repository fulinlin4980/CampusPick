<view class="task-card-container">
  
  <view class="card-header">
    <view class="time-info">
      <text class="task-type-label">{{taskTypeLabel}}</text>
    </view>
    <view class="status-badge {{statusBadge.class}}">
      {{statusBadge.text}}
    </view>
  </view>
  
  <view class="time-footer">
    <text class="icon-clock">âŒš</text>
    å‘å¸ƒäº {{formattedTime}}
  </view>

  <view wx:if="{{task.type === 'express' && isMyTask}}" class="pickup-code-box">
    <block wx:if="{{canSeePickupCode}}">
      <view class="pickup-title">ğŸ”‘ å–ä»¶ç /ä¿¡æ¯ (ä»…æ‚¨å¯è§)</view>
      <view class="pickup-content">{{task.pickupCode}}</view>
    </block>
    <block wx:elif="{{task.status === 'PENDING'}}">
      <view class="pickup-hidden">
        ğŸ’¡ **éšç§ä¿æŠ¤ï¼š** è¯·å…ˆç‚¹å‡»ã€ç«‹å³æ¥å•ã€‘ï¼Œå–ä»¶ç æ‰ä¼šæ˜¾ç¤ºã€‚
      </view>
    </block>
    <block wx:else>
      <view class="pickup-hidden">
        ä¿¡æ¯å·²é”å®šã€‚
      </view>
    </block>
  </view>
  
  <view class="route-info-box">
    <view class="route-item">
      <view class="dot-icon dot-blue"></view>
      <view class="route-text-container">
        <text class="route-label">å–è´§ç‚¹</text>
        <text class="route-location">{{task.pickupLocation || task.campus}}</text>
      </view>
    </view>
    
    <view class="route-line"></view>
    
    <view class="route-item">
      <view class="dot-icon dot-red"></view>
      <view class="route-text-container">
        <text class="route-label">é€è¾¾ç‚¹</text>
        <text class="route-location">{{task.deliveryLocation || task.campus}}</text>
      </view>
    </view>
  </view>

  <view class="description-box">
    <text class="icon-package">ğŸ’¬</text>
    {{task.description || "æ— å¤‡æ³¨"}}
    
    <view wx:if="{{requirePhoto && isMyTask && task.status === 'ACCEPTED'}}" class="delivery-requirement">
        ğŸ“¸ **æé†’ï¼š** å®Œæˆä»»åŠ¡éœ€**ä¸Šä¼ é€è¾¾ç…§ç‰‡**ã€‚
    </view>
    
    <view wx:if="{{task.status === 'CANCELLED' && task.cancelReason}}" class="cancel-reason">
      <text class="icon-alert">âš ï¸</text>
      <text>å–æ¶ˆåŸå› : {{task.cancelReason}}</text>
    </view>
  </view>

  <view class="card-footer">
    <view class="price-display">
      <text class="price-symbol">Â¥</text>
      <text class="price-value">{{task.price ? task.price.toFixed(2) : '0.00'}}</text>
    </view>

    <view class="action-buttons">
      
      <block wx:if="{{isMine && task.status === 'PENDING'}}">
        <mp-button variant="ghost" size="sm" data-action="cancel" bindtap="handleAction">
          å–æ¶ˆ
        </mp-button>
      </block>

      <block wx:elif="{{!isMine && task.status === 'PENDING'}}">
        <mp-button variant="primary" size="sm" data-action="accept" bindtap="handleAction"> 
          ç«‹å³æ¥å•
        </mp-button>
      </block>

      <block wx:elif="{{isMyTask && task.status === 'ACCEPTED'}}">
        <mp-button variant="secondary" size="sm" data-action="delivery" bindtap="handleAction">
          âœ… ç¡®è®¤é€è¾¾
        </mp-button>
      </block>
      
      <block wx:elif="{{isMine && task.status === 'DELIVERED'}}">
        <mp-button variant="primary" size="sm" data-action="confirmreceipt" bindtap="handleAction">
          ğŸ›’ ç¡®è®¤æ”¶è´§
        </mp-button>
      </block>

      <block wx:elif="{{isMine && task.status === 'ACCEPTED'}}">
        <text class="status-message message-blue">åŒå­¦æ­£åœ¨é…é€ä¸­...</text>
      </block>
      <block wx:elif="{{isMine && task.status === 'DELIVERED'}}">
        <text class="status-message message-purple">å·²é€è¾¾ï¼Œè¯·ç¡®è®¤</text>
      </block>
      
    </view>
  </view>
</view>